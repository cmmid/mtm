---
title: "04. Ordinary differential equations (ODEs): Solutions"
---

**Click [here](04_ODEs_practical.qmd) to return to the practical.**

## Practical 1: Solving ODEs using `deSolve`

### SI model

[ODE SI model in R.](04_ODEs_SI_code.qmd)

1.  After you have coded the model, answer the following questions:
    (a) Increase the initial number of infectious individuals. What happens to the output? **Answer**: The number of infectious individuals has a higher starting point, but the same growth rate from that level, and the same endpoint.
    (b) What does the `by` argument in the `times` vector represent? **Answer**: The time steps at which the model solution is evaluated.
    (c) Increase the value of the `by` argument. What happens to the output? HINT: plot using `type = "b"` to plot both lines and points. **Answer**: The solution points become more spaced out, but trace the same underlying curve.

### SIR model

[ODE SIR model in R.](04_ODEs_SIR_code.qmd)

2.  Once you have coded the model:
    (a) Plot the output of the SIR model with different colours for Susceptible, Infected and Recovered individuals. **Answer**: See example solution.
    (b) Change the value of the transmission rate so that the basic reproduction number is less than one, i.e. $R_0 < 1$. What happens to the output? **Answer**: Recall that for an SIR model, the basic reproduction number $R_0 = \beta / \gamma$. When $R_0 < 1$, the epidemic does not take off.

### SEIR model

[ODE SEIR model in R.](04_ODEs_SEIR_code.qmd)

3.  Once you have coded the model:
    (a) Plot the output of the SEIR model with different colours for Susceptible, Exposed, Infected and Recovered individuals. **Answer**: See example solution.
    (b) How does the model output differ from the SIR model you coded previously? **Answer**: Approximately the same number of people get infected, but the epidemic takes approximately twice as long. This is because the generation interval is twice as long in the SEIR model, but the reproduction number is the same as for the SIR model. See [Wallinga and Lipsitch 2007](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1766383/), especially section 3a, for discussion of the generation interval, the growth rate and the reproduction number in epidemic models.

### SEIRV model

[ODE SEIRV model in R.](04_ODEs_SEIRV_code.qmd)

![](images/SEIRV_diagram.png)

4.  Extend the SEIR model to include a vaccinated class:
    (a) Draw the model diagram. **Answer**: See above.
    (b) Implement the model in R starting from your SEIR code. **Answer**: See example solution.
